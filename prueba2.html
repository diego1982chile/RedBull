<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>  
<link href="css/jquery-ui-1.10.2.custom.min.css" rel="stylesheet" />

<style>
	
	table tr td{
		text-align: center;
		font-family: "Arial",Georgia,Serif;
		
	}	
	h4,h5,div,table{
		padding:0em;
		margin:0em;
	}
	.seleccionada{
		background:blue;
		color:white;
	}
	
</style>

<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="js/taffy.js"></script>
<script type="text/javascript" src="js/json2.js"></script>
<!--script type="text/javascript" src="js/jquery-ui-1.10.2.custom.min.js"></script-->
<script type="text/javascript" src="js/jquery.dataTables.min.js"></script>

<script>

/**
 * Very simple way to check if a file exists on this domain.
 * Use with the jQuery library.
 *
 * Important: 	Works only on the same domain. 
 * 		Cross-domain-requests have to be done in another way (see JSONP)!
 *
 * Use: console.log(   "/data/list.json".fileExists()  );
 */
String.prototype.fileExists = function() {
	filename = this;
	
	var response = jQuery.ajax({
		url: filename,
		type: 'HEAD',
		async: false
	}).status;		
	return (response != "200") ? false : true;
}

	// Indice comienza en 1
	
		var cursor=1;
        var id_respuesta=1;
		// var id_toma=1;			
		var htmlTeclado="<div style='height:50px'><input id='valor' /></div>";
        
		// Estas variables se usan para identificar el archivo con la toma
		var codigo_auditor;
		var folio_sala;
		
        var preguntasDB;
        var seccionesDB;		
        var topicosDB;        
        var categoriasDB;									
        var preguntas_categoriasDB;											
        var itemesDB;								
        var alternativasDB;	    	

	// var pathCuestionario="cuestionario.txt"
	var pathCuestionario="\\Application\\cuestionario.txt";
		
	function respuesta(id_respuesta,valor_respuesta,id_item,id_pregunta,id_categoria)
	{
            this.id_respuesta=id_respuesta;
            this.valor_respuesta=valor_respuesta;               
            this.id_item=id_item;
            this.id_pregunta=id_pregunta;	
            this.id_categoria=id_categoria;
	}	
	
	function toma(fecha_toma,estado_toma,id_auditor,id_sala,respuestas)
	{		
		this.fecha_toma=fecha_toma;
		this.estado_toma=estado_toma;		
		this.id_auditor=id_auditor;
		this.id_sala=id_sala;
		this.respuestas=respuestas;
	}	

	var respuestas= new Array();

	var respuestasDB= TAFFY(respuestas); 			

	// Carga de datos en los contenedores de objetos
	
	function cargar_datos()
	{								
		// cargar_respuestas();
			$.getJSON('data/topicos.txt',function(data){					
				topicosDB=TAFFY(data);
				$.getJSON('data/secciones.txt',function(data){
					seccionesDB=TAFFY(data);
					$.getJSON('data/categorias.txt',function(data){
						categoriasDB=TAFFY(data);
						$.getJSON('data/preguntas.txt',function(data){			
							preguntasDB=TAFFY(data);	
							$.getJSON('data/preguntas_categorias.txt',function(data){
								preguntas_categoriasDB=TAFFY(data);
								$.getJSON('data/itemes.txt',function(data){
									itemesDB=TAFFY(data);
									$.getJSON('data/alternativas.txt',function(data){
										alternativasDB=TAFFY(data);									
										// cargar_contenido(cursor);											
										var callbacks = $.Callbacks();	
										// Primero decorar tabla cuestionario											
										callbacks.add( decorar_cuestionario() );
										// Decorar resto de las tablas
										callbacks.add( decorar_tablas() );										
										// Luego agregar las tablas de preguntas a la tabla cuestionario
										// callbacks.add( crear_cuestionario() );											
										// Luego cargar el contenido en las tablas de preguntas										
										// callbacks.add( cargar_contenidos() );																																					
									});									
								});	
							});		
						});	
					});	
				});				
			});				
	}
	
	// Carga de datos en los contenedores de objetos
	
		function cargar_auditores()
		{										
									
			var xmlhttp;
			if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari				
				xmlhttp=new XMLHttpRequest();				
			}
			else{// code for IE6, IE5				
				xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");				
			}
																	
			xmlhttp.onreadystatechange=function(){
													
				if (xmlhttp.readyState==4 && xmlhttp.status==200)
				{									
					var data = JSON.parse(xmlhttp.responseText);											
					
					var html="<table id='tabla_auditores' width='100%'><thead><tr><th>Seleccione auditor</th></tr></thead><tbody>";
				
					$(data).each(function(key,value){															
						html=html+"<tr><td><button id_auditor="+value.id_auditor+" codigo_auditor="+value.codigo_auditor+" class='auditor' style='width=400px'><label style='font-size:2em'>"+value.nombre_auditor+"</label></button></td></tr>";
					});
					html=html+"</tbody></table>";
					// alert(html);					
					$('#auditores').html(html);
					$('#tabla_auditores').dataTable({
						"sScrollY": "215px",		 		 		
						"bFilter": true,
						"bSort": false,
						"bInfo": false,
						"bPaginate": false,
						"bJQueryUI": false,
						"bAutoWidth": false, 		
					});			
					
					$('.auditor').click(function(){											
						
						$('#salas').html('Cargando salas...');
						$('.ui-state-active').removeClass();
						$(this).addClass('ui-state-active');
					
						codigo_auditor=$(this).attr('codigo_auditor');
						var id_auditor=$(this).attr('id_auditor');
					
						var xmlhttp;
						if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari				
							xmlhttp=new XMLHttpRequest();				
						}
						else{// code for IE6, IE5							
							xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");				
						}												
											
						xmlhttp.onreadystatechange=function(){												
													
							if (xmlhttp.readyState==4 && xmlhttp.status==200)
							{																	
								var data = JSON.parse(xmlhttp.responseText);	
								
								if($.isEmptyObject(data))
								{
									alert("No existen salas asignadas para este auditor");
									$('#salas').html('');
								}
								else
								{
									var html="<table id='tabla_salas' width='100%'><thead><tr><th>Seleccione sala</th></tr></thead><tbody>";
							
									$(data).each(function(key,value){																			
										html=html+"<tr title='"+value.direccion+"'><td><button class='sala' folio_sala="+value.folio+" style='width=400px'><label style='font-size:1.5em'>"+value.folio+"/"+value.calle+"-"+value.numero+"</label></button></td></tr>";									
									});
									html=html+"</tbody></table>";
		
									$('#loader').hide();
									$('#salas').html(html);
								
									$('#tabla_salas').dataTable({
										"sScrollY": "215px",		 		 		
										"bFilter": true,
										"bSort": false,
										"bInfo": false,
										"bPaginate": false,
										"bJQueryUI": false,
										"bAutoWidth": false, 																				
									});

									$('.sala').click(function(){
										
										folio_sala=$(this).attr('folio_sala');
										
										// pathCuestionario="\\Application\\toma"+codigo_auditor+folio_sala+".txt";
										pathCuestionario="toma51151028001.txt";
										
										$('#sesion').hide(),
										$('#container').show();
										// cargar_datos();
										
										if(pathCuestionario.fileExists())
										{									
											$.getJSON(pathCuestionario,function(data){					
											respuestasDB=TAFFY(data.respuestas);
												if(parseInt(data.estado_toma)==1)
												{																														
													if(confirm("Esta sesión corresponde a una toma pendiente en este equipo. ¿Desea cargar los datos de esta toma?"))
													{														
														cargar_contenidos();
														// setTimeout(function(){cargar_listeners()},30000)														
													}
												}
												else
												{
													if(confirm("Esta sesión corresponde a una toma completada en este equipo. ¿Desea cargar los datos de esta toma?"))
													{
														cargar_contenidos();
														// setTimeout(function(){cargar_listeners()},30000)
													}
												}												
											});		
										}	
										else
										{
											alert("Esta sesión corresponde a una nueva toma en este equipo. Se cargará el cuestionario");											
											cargar_contenidos();
											// setTimeout(function(){cargar_listeners()},30000)
										}										
									});
								}																										
							}
						}						
						xmlhttp.open("GET","http://200.29.139.244/REDBULL/php/cargar_maestra.php?caso=2&id_auditor='"+id_auditor+"'",true);
						xmlhttp.send();	
					});						
				}
			}
			xmlhttp.open("GET",'http://200.29.139.244/REDBULL/php/cargar_maestra.php?caso=1',true);
			xmlhttp.send();			
		}
	
	// Carga el contenido desde objetos 'consultables' a partir de los contenedores
	
    function cargar_contenido(id_pregunta)
    {					     					
        // Filtrar preguntas por id_pregunta segun cursor actual		
        preguntasDB().filter({'id_pregunta':id_pregunta}).each(function (r1) { 

            seccionesDB().filter({'id_seccion':r1.id_seccion}).each(function (r2) { 

                topicosDB().filter({'id_topico':r2.id_topico}).each(function (r3) { 
				
					$('#head_topico'+r3.id_topico).html("<h5 style='color:"+r3.color_letra+"'>"+r3.numero_topico+'. '+r3.nombre_topico+"<h5>");
					$('#head_topico'+r3.id_topico).css('background-color',r3.color_topico);
					
					$('#seccion'+r3.id_topico+r2.id_seccion+' thead tr th').html("<h5>"+r3.numero_topico+"."+r2.numero_seccion+" "+r2.nombre_seccion+"</h5>");
                    $('#seccion'+r3.id_topico+r2.id_seccion+' thead tr th').css('background-color',r2.color_seccion);										                

					$('#seccion'+r3.id_topico+r2.id_seccion).dataTable().fnAddData(["<h5 style='padding:0em'>"+r3.numero_topico+'.'+r2.numero_seccion+'.'+r1.numero_pregunta+' '+r1.contenido_pregunta+"</h5>"]);					
					
                    switch(parseInt(r1.tipo))
                    {
                        case 1:// Tipo alternativa => cargar las alternativas para esta pregunta
                            // Verificar si existen categorias para esta pregunta	                                                       
							
							var tiene_categoria=false;
                            
							preguntas_categoriasDB().filter({'id_pregunta':id_pregunta}).each(function () {
                                tiene_categoria=true;
                                return false;
                            });
																					
							switch(parseInt(r1.tipo2))
							{								
								case 1: // Tipo disyuntiva
									if(tiene_categoria)									
									{                      																		
										var html="<table id='tabla_alternativas"+cursor+"' width='100%' border='1' align='left'>";										
										
										preguntas_categoriasDB().filter({'id_pregunta':id_pregunta}).each(function (r5) {															
											
											categoriasDB().filter({'id_categoria':r5.id_categoria}).each(function (r6) {
																				
											var cont=0;
											
											alternativasDB().filter({'id_categoria':r5.id_categoria},{'id_pregunta':id_pregunta}).each(function (r9){
												cont++;
											});											
											html=html+"<tr><td width='25%' style='text-align:left' rowspan='"+cont+"'>"+r6.nombre_categoria+"</td>";											
											var cont=1;

											alternativasDB().filter({'id_categoria':r5.id_categoria},{'id_pregunta':id_pregunta}).each(function (r7) {

											itemesDB().filter({'id_item':r7.id_item}).each(function (r8) {

												if(cont===1)
													html=html+"<td width='75%' style='text-align:left'><input type='radio' id='radio"+cont+"' pregunta='"+cursor+"' categoria='"+r5.id_categoria+"' item='"+r7.id_item+"' name='radio"+cursor+r5.id_categoria+"' /><label style='font-size:0.9em'>"+r8.nombre_item+"</label></td></tr>";                                                                                                
												else                                                                                                
													html=html+"<tr id='"+r8.id_item+"'><td item='"+r7.id_item+"' style='text-align:left'><input type='radio' id='radio"+cont+"' pregunta='"+cursor+"' categoria='"+r5.id_categoria+"' item='"+r7.id_item+"' name='radio"+cursor+r5.id_categoria+"' value='"+r5.id_categoria+r8.id_item+"' /><label style='font-size:0.9em'>"+r8.nombre_item+"</label></td></tr>";										
											});	
											cont++;
											});																																	
										});			
									});	
									html=html+"</table>";                         
									}
									else
									{
										// Si no existen categorias para esta pregunta, cargar directamente las alternativas
										var html="<table id='tabla_alternativas"+cursor+"' width='100%' border='1' align='left'>";
										var cont=1;
										alternativasDB().filter({'id_pregunta':id_pregunta}).each(function (r5) {					
												cont++;
												itemesDB().filter({'id_item':r5.id_item}).each(function (r6) {									
														html=html+"<tr><td id='"+r6.id_item+"' style='text-align:left'><input type='radio' id='radio"+cont+"' pregunta='"+cursor+"' categoria='"+r5.id_categoria+"' item='"+r5.id_item+"' name='radio"+cursor+r5.id_categoria+"' value='"+r6.id_item+"' /><label style='font-size:0.9em'>"+r6.nombre_item+"</label></td></tr>";										
												});															
										});		
										html=html+"</table>";									
									}					
									$('#seccion'+r3.id_topico+r2.id_seccion).dataTable().fnAddData([html]);
									// $('#respuesta').html(html);   															
									
									// Si existen respuestas buscar las respuestas correspondiente a la pregunta actual y cargarlas
																		
									respuestasDB().filter({'id_pregunta':id_pregunta}).each(function (r10) {											
										$('[name=radio'+id_pregunta+r10.id_categoria+']').filter('[categoria="'+r10.id_categoria+'"][item="'+r10.id_item+'"]').prop('checked', true);
										$('[name=radio'+id_pregunta+r10.id_categoria+']').filter('[categoria="'+r10.id_categoria+'"][item="'+r10.id_item+'"]').parent().addClass("seleccionada");
									});										
									
									break;
								case 2: // Tipo conjuntiva
									if(tiene_categoria)
									{                         										
										var html="<table id='tabla_alternativas"+cursor+"' width='100%' border='1' align='left'>";

										preguntas_categoriasDB().filter({'id_pregunta':id_pregunta}).each(function (r5) {

											categoriasDB().filter({'id_categoria':r5.id_categoria}).each(function (r6) {
																				
											var cont=0;
											
											alternativasDB().filter({'id_categoria':r5.id_categoria},{'id_pregunta':id_pregunta}).each(function (r9){
												cont++;
											});											
											html=html+"<tr><td width='30%' style='text-align:left' rowspan='"+cont+"'>"+r6.nombre_categoria+"</td>";											
											var cont=1;

											alternativasDB().filter({'id_categoria':r5.id_categoria},{'id_pregunta':id_pregunta}).each(function (r7) {

											itemesDB().filter({'id_item':r7.id_item}).each(function (r8) {

												if(cont===1)
													html=html+"<td width='70%' style='text-align:left'><input type='checkbox' id='radio"+cont+"' pregunta='"+cursor+"' categoria='"+r5.id_categoria+"' item='"+r7.id_item+"' name='checkbox' /><label style='font-size:0.9em'>"+r8.nombre_item+"</label></td></tr>";                                                                                                
												else                                                                                                
													html=html+"<tr width='50%' id='"+r8.id_item+"'><td item='"+r7.id_item+"' style='text-align:left'><input type='checkbox' id='radio"+cont+"' pregunta='"+cursor+"' categoria='"+r5.id_categoria+"' item='"+r7.id_item+"' name='checkbox' value='"+r5.id_categoria+r8.id_item+"' /><label style='font-size:0.9em'>"+r8.nombre_item+"</label></td></tr>";										
											});	
											cont++;
											});										
										});			
									});	
									html=html+"</table>";                         
									}
									else
									{
										// Si no existen categorias para esta pregunta, cargar directamente las alternativas
										var html="<table id='tabla_alternativas"+cursor+"' width='100%' border='1' align='left'>";
										var cont=1;
										alternativasDB().filter({'id_pregunta':id_pregunta}).each(function (r5) {					
											cont++;
											itemesDB().filter({'id_item':r5.id_item}).each(function (r6) {									
													html=html+"<tr><td id='"+r6.id_item+"' style='text-align:left'><input type='checkbox' id='radio"+cont+"' pregunta='"+cursor+"' categoria='"+r5.id_categoria+"' item='"+r5.id_item+"' name='checkbox' value='"+r6.id_item+"' /><label style='font-size:0.9em'>"+r6.nombre_item+"</label></td></tr>";										
											});															
										});		
										html=html+"</table>";									
									}  															
									$('#seccion'+r3.id_topico+r2.id_seccion).dataTable().fnAddData([html]);
									// Si existen respuestas buscar las respuestas correspondientes a la pregunta actual y cargarlas
																		
									respuestasDB().filter({'id_pregunta':id_pregunta}).each(function (r10) {							
										$('[name=checkbox]').filter('[pregunta='+id_pregunta+'][categoria="'+r10.id_categoria+'"][item="'+r10.id_item+'"]').prop('checked', true);
										$('[name=checkbox]').filter('[pregunta='+id_pregunta+'][categoria="'+r10.id_categoria+'"][item="'+r10.id_item+'"]').parent().addClass("seleccionada");
									});																																		
									break;																					                                                     
								case 3: // Tipo conjuntiva con valor	
									var html="";
									
									if(tiene_categoria)
									{                         													
										html=html+"<div><table id='tabla_alternativas"+cursor+"' width='100%' border='1' align='left'></div>";

										preguntas_categoriasDB().filter({'id_pregunta':id_pregunta}).each(function (r5) {

											categoriasDB().filter({'id_categoria':r5.id_categoria}).each(function (r6) {
																				
											var cont=0;
											
											alternativasDB().filter({'id_categoria':r5.id_categoria},{'id_pregunta':id_pregunta}).each(function (r9){
												cont++;
											});											
											html=html+"<tr><td width='20%' style='text-align:left' rowspan='"+cont+"'>"+r6.nombre_categoria+"</td>";											
											var cont=1;

											alternativasDB().filter({'id_categoria':r5.id_categoria},{'id_pregunta':id_pregunta}).each(function (r7) {

											itemesDB().filter({'id_item':r7.id_item}).each(function (r8) {

												if(cont===1)
													html=html+"<td width='50%' style='text-align:left'><label style='font-size:0.9em'>"+r8.nombre_item+"</label></td><td width='20%'><input id='valor"+cursor+r5.id_categoria+r7.id_item+"' pregunta='"+cursor+"' categoria='"+r5.id_categoria+"' item='"+r7.id_item+"' name='input"+r5.id_categoria+r7.id_item+"' class='valor' size='4' /></td></tr>";                                                                                                
												else                                                                                                
													html=html+"<tr width='50%' id='"+r8.id_item+"'><td item='"+r7.id_item+"' style='text-align:left'><label style='font-size:0.9em'>"+r8.nombre_item+"</label></td><td width='20%'><input id='valor"+cursor+r5.id_categoria+r7.id_item+"' pregunta='"+cursor+"' categoria='"+r5.id_categoria+"' item='"+r7.id_item+"' name='input"+r5.id_categoria+r7.id_item+"' class='valor' size='4' /></td></tr>";										
											});	
											cont++;
											});										
										});			
									});	
									html=html+"</table>";                         
									}
									else
									{										
										// Si no existen categorias para esta pregunta, cargar directamente las alternativas
										html=html+"<div><table id='tabla_alternativas"+cursor+"' width='100%' border='1' align='left'></div>";
										var cont=1;
										alternativasDB().filter({'id_pregunta':id_pregunta}).each(function (r5) {					
												cont++;
												itemesDB().filter({'id_item':r5.id_item}).each(function (r6) {									
													html=html+"<tr><td id='"+r6.id_item+"' style='text-align:left' width='50%'><label style='font-size:0.9em'>"+r6.nombre_item+"</label></td><td width='20%'><input id='valor"+cont+"' pregunta='"+cursor+"' categoria='"+r5.id_categoria+"' item='"+r5.id_item+"' name='input"+r5.id_categoria+r5.id_item+"' class='valor' size='4' /></td></tr>";										
												});															
										});		
										html=html+"</table>";									
									}															
									$('#seccion'+r3.id_topico+r2.id_seccion).dataTable().fnAddData([html]);																		
									// Si existen respuestas buscar las respuestas correspondientes a la pregunta actual y cargarlas
																		
									respuestasDB().filter({'id_pregunta':id_pregunta}).each(function (r10) {											
										$('[name=input'+r10.id_categoria+r10.id_item+']').val(r10.valor_respuesta);
									});																																																																                           																			
									break;		
							}
                            break;							
                        case 2:// Tipo numerico => cargar un input                                                        
                            var html="<div style='height:50px'><input id='valor"+id_pregunta+"' /></div>";
                            // $('#respuesta').html(html);
							$('#seccion'+r3.id_topico+r2.id_seccion).dataTable().fnAddData([html]);
							
							// Si existen respuestas buscar las respuestas correspondiente a la pregunta actual y cargarlas
							// alert('voy a cargar la respuesta');				
							respuestasDB().filter({'id_pregunta':cursor}).each(function (r10) {	
								// alert(r10.valor_respuesta);
								$('#valor'+id_pregunta).val(r10.valor_respuesta);								
							});							
                            // $('#valor').css('font-size','20px');					
                            break;				
                    }						
                });
            });
        });				
    }
	
	// Carga listener para eventos para cada pregunta y sus validaciones
	
    function cargar_listener(id_pregunta)
    {					     			
        // Filtrar preguntas por id_pregunta segun cursor actual		
        preguntasDB().filter({'id_pregunta':id_pregunta}).each(function (r1) { 			
			
            seccionesDB().filter({'id_seccion':r1.id_seccion}).each(function (r2) { 

                topicosDB().filter({'id_topico':r2.id_topico}).each(function (r3) { 				          

                    switch(parseInt(r1.tipo))
                    {
                        case 1:// Tipo alternativa => cargar las alternativas para esta pregunta
                            // Verificar si existen categorias para esta pregunta	                                                       							
																					
							switch(parseInt(r1.tipo2))
							{								
								case 1: // Tipo disyuntiva																																										
									$('#tabla_alternativas'+cursor+' tr td').click(function(){
										$('[name=radio'+$(this).children().attr('pregunta')+$(this).children().attr('categoria')+']').parent('.seleccionada').removeClass();
										$(this).addClass("seleccionada");                                
										$('[name=radio'+$(this).children().attr('pregunta')+$(this).children().attr('categoria')+']').filter('[pregunta='+$(this).children().attr('pregunta')+'][categoria="'+$(this).children().attr('categoria')+'"][item="'+$(this).children().attr('item')+'"]').prop('checked', true);                                
										guardarRespuesta(id_pregunta,$(this).children().attr('categoria'),$(this).children().attr('item'),null);																																						
									});													
									break;
								case 2: // Tipo conjuntiva				
									$('#tabla_alternativas'+cursor+' tr td').click(function(){										
										if($(this).children().prop('checked'))
										{
											$(this).removeClass("seleccionada");
											$('[name=checkbox]').filter('[pregunta='+$(this).children().attr('pregunta')+'][categoria="'+$(this).children().attr('categoria')+'"][item="'+$(this).children().attr('item')+'"]').prop('checked', false);											
											if($.inArray(id_pregunta,[15,17])!=-1)
											{
												if($('[name=input'+$(this).children().attr('categoria')+$(this).children().attr('item')+']').val()!='')
												{
													alert("Existe un precio ingresado en la siguiente pregunta. Debe quitar el precio o volver a marcar el SKU");
													$('input').filter('[pregunta='+id_pregunta+1+'][categoria="'+$(this).children().attr('categoria')+'"][item="'+$(this).children().attr('item')+'"]').focus();
												}
											}											
										}
										else
										{
											$(this).addClass("seleccionada");        											
											$('[name=checkbox]').filter('[pregunta='+$(this).children().attr('pregunta')+'][categoria="'+$(this).children().attr('categoria')+'"][item="'+$(this).children().attr('item')+'"]').prop('checked', true);
										
											if($.inArray(id_pregunta,[15,17])!=-1)
											{ // Si se ingreso algun precio, el SKU debe estar previamente marcado
												if($('[name=input'+$(this).children().attr('categoria')+$(this).children().attr('item')+']').val()=='')
												{
													alert("El precio correspondiente en la siguiente pregunta no está ingresado. Debe ingresar un precio o desmarcar el SKU");
													$(this).val('');
												}
											}
										}										
										guardarRespuesta(id_pregunta,$(this).children().attr('categoria'),$(this).children().attr('item'),null);  																											
									});																													
									break;																					                                                     
								case 3: // Tipo conjuntiva con valor
									var pregunta=$('.valor:first').attr('pregunta');								
									var categoria=$('.valor:first').attr('categoria');
									var item=$('.valor:first').attr('item');
									
									$('[categoria='+categoria+'][item='+item+']').focus();
									
									$('.valor').focusin(function(){
										pregunta=$(this).attr('pregunta');
										categoria=$(this).attr('categoria');
										item=$(this).attr('item');
									});	
									$('.valor').keyup(function(event){	
																			
										if(parseInt($(this).val()).toString()!="NaN")
										{
											$(this).val(parseInt($(this).val()));
											
											// Validacion de precios segun SKUs con flejes (grupo1)
												
											if($.inArray(id_pregunta,[18,20])!=-1)
											{																								
												// Si se ingreso algun precio, el SKU debe estar previamente marcado
												if(!$('[name=checkbox]').filter('[pregunta='+id_pregunta-1+'][categoria="'+$(this).attr('categoria')+'"][item="'+$(this).attr('item')+'"]').is(':checked'))
												{
													alert("El 'SKU' correspondiente no está marcado en la pregunta anterior. Debe quitar el precio o marcar el SKU");
													$('[name=checkbox]').filter('[pregunta='+id_pregunta-1+'][categoria="'+$(this).attr('categoria')+'"][item="'+$(this).attr('item')+'"]').focus();
												}												
											}												
										}
										else
										{					
											// Si se quito un precio el SKU debe estar desmarcado
											if($(this).val()=='')
											{
												if($('[name=checkbox]').filter('[pregunta='+id_pregunta-1+'][categoria="'+$(this).attr('categoria')+'"][item="'+$(this).attr('item')+'"]').is(':checked'))
												{
													alert("El 'SKU' correspondiente está marcado en la pregunta anterior. Debe ingresar un precio o desmarcar el SKU");
													$('[name=checkbox]').filter('[pregunta='+id_pregunta-1+'][categoria="'+$(this).attr('categoria')+'"][item="'+$(this).attr('item')+'"]').focus();
												}											
											}																				
										}
									});
									break;		
							}
                            break;							
                        case 2:// Tipo numerico => cargar un input     

							$('#valor'+id_pregunta).keyup(function(event){								
							
								if(parseInt($(this).val()).toString()!="NaN")
								{
									$(this).val(parseInt($(this).val()));
									if(id_pregunta==33)
									{
										$('#tabla_alternativas34 tr:gt('+$(this).val()+')').each(function(){
											$(this).css('background','blue');
											$(this).hide();
										});
										$('#tabla_alternativas35 tr:gt('+$(this).val()+')').each(function(){
											$(this).css('background','blue');
											$(this).hide();
										});		
										$('#tabla_alternativas36 tr:gt('+$(this).val()+')').each(function(){
											$(this).css('background','blue');
											$(this).hide();
										});		
										$('#tabla_alternativas37 tr:gt('+$(this).val()+')').each(function(){
											$(this).css('background','blue');
											$(this).hide();
										});		
										$('#tabla_alternativas38 tr:gt('+$(this).val()+')').each(function(){
											$(this).css('background','blue');
											$(this).hide();
										});						
										$('#tabla_alternativas39 tr:gt('+$(this).val()+')').each(function(){
											$(this).css('background','blue');
											$(this).hide();
										});						
										$('#tabla_alternativas40 tr:gt('+$(this).val()+')').each(function(){
											$(this).css('background','blue');
											$(this).hide();
										});	
										$('#tabla_alternativas41 tr:gt('+$(this).val()+')').each(function(){
											$(this).css('background','blue');
											$(this).hide();
										});																							
									}
									// Validacion totales primer grupo
									if($.inArray(id_pregunta,[1,2,3,4,5,6])!=-1)
									{
										if(parseInt($('#valor1').val())<parseInt($('#valor2').val())+parseInt($('#valor3').val())+parseInt($('#valor4').val())+parseInt($('#valor5').val())+parseInt($('#valor6').val()))
										{
											alert("El 'facing' total no puede ser inferior a la suma de 'facings' parciales");
											$(this).val('');
										}
										if(parseInt($('#valor2').val())<parseInt($('#valor3').val())+parseInt($('#valor4').val())+parseInt($('#valor5').val()))
										{
											alert("El 'facing' total de SKUs REDBULL no puede ser inferior a la suma de 'facings' parciales de SKUs REDBULL");
											$(this).val('');
										}
									}
									// Validacion totales segundo grupo
									if($.inArray(id_pregunta,[10,11,12,13])!=-1)
									{
										if(parseInt($('#valor10').val())<parseInt($('#valor11').val())+parseInt($('#valor12').val())+parseInt($('#valor13').val()))
										{
											alert("El 'facing' total no puede ser inferior a la suma de 'facings' parciales");
											$(this).val('');
										}
									}										
								}
								else
								{
									$(this).val('');
								}
								
								// Si esta en pregunta 33 las preguntas siguientes son dependientes de lo que se ingrese aqui
							});															
                            break;				
                    }						
                });
            });
        });
    }	
	
	function cargar_contenidos(){				
		alert('voy a entrar');
		while(cursor<20)
		{		
			cargar_contenido(cursor);
			cursor++;
		}
		cursor=1;
		alert('sali');
	}
	
	function cargar_listeners(){		
		
		alert('listeners');
		while(cursor<20)
		{		
			cargar_listener(cursor);
			cursor++;
		}
		cursor=1;
	}
	
	function crear_cuestionario()
	{
		var cont=1;

		while(cont<42)
		{
			var html="<div id='contenedor_pregunta"+cont+"'><table id='pregunta"+cont+"' width='100%'>";
			html+="<tr><td id='topico_pregunta"+cont+"'></td></tr>";
			html+="<tr><td id='seccion_pregunta"+cont+"'></td></tr>";
			html+="<tr><td id='contenido_pregunta"+cont+"'></td></tr>";
			html+="<tr><td id='respuesta_pregunta"+cont+"'></td></tr>";
			html+="</table></div>";					
			$('#cuestionario').dataTable().fnAddData([html]);
			cont++;
		}
	
	}
	
	function decorar_tablas(){
			
		$('.miDataTable').dataTable({
		// "sScrollY": "520px",		 		 		
		"bFilter": false,
		"bSort": false,
		"bInfo": false,
		"bPaginate": false,
		"bJQueryUI": false,
		"bAutoWidth": false, 		
		"aoColumnDefs": [{ "aTargets": [0] }],		
		});		
		
		$('#tabla_tomas').dataTable({
		"sScrollY": "520px",		 		 		
		"bFilter": true,
		"bSort": false,
		"bInfo": false,
		"bPaginate": false,
		"bJQueryUI": true,
		"bAutoWidth": false, 				
		});				
	}
	
	function decorar_cuestionario()
	{
		$('#cuestionario').dataTable({
			// "sScrollY": "520px",		 		 		
			"bFilter": false,
			"bSort": false,
			"bInfo": false,
			"bPaginate": false,
			"bJQueryUI": false,
			"bAutoWidth": false, 
			"aoColumnDefs": [{ "aTargets": [0] }],
		});	
	}
	
    function guardarRespuesta(id_pregunta,id_categoria,id_item,valor)    
    {		
        var existeRespuesta=false;
        var tipoPregunta;		       
		
		preguntasDB().filter({'id_pregunta':id_pregunta}).each(function (r0) {
            tipoPregunta=r0.tipo2;
            return false;
        });		
		
		switch(parseInt(tipoPregunta))
		{
			case 1: // TIPO DISYUNTIVA -> Buscar si existe la misma: pregunta y categoria			
				respuestasDB().filter({'id_pregunta':id_pregunta,'id_categoria':id_categoria}).each(function () {
					existeRespuesta=true;
					return false;
				});							
				if(existeRespuesta)// Si existe la respuesta, actualizarla
				{
					respuestasDB({'id_pregunta':id_pregunta,'id_categoria':id_categoria}).update({valor_respuesta:valor,id_item:id_item,id_categoria:id_categoria});
				}
				else // Sino existe la respuesta, agregarla		
				{
					respuestasDB.insert(new respuesta(id_respuesta,valor,id_item,id_pregunta,id_categoria));              
					id_respuesta++;
				}
				break;
			case 2: // TIPO CONJUNTIVA => Buscar si existe la misma: pregunta, categoria e item
				respuestasDB().filter({'id_pregunta':id_pregunta,'id_categoria':id_categoria,'id_item':id_item}).each(function () {
					existeRespuesta=true;
					return false;
				});						
				if(existeRespuesta)  // Si existe la respuesta, eliminarla
				{ 					
					respuestasDB({'id_pregunta':id_pregunta,'id_categoria':id_categoria,'id_item':id_item}).remove();
					id_respuesta--;
				}
				else // Sino existe la respuesta, agregarla
				{
					respuestasDB.insert(new respuesta(id_respuesta,valor,id_item,id_pregunta,id_categoria));              
					id_respuesta++;
				}				
				break;		
			case 3:
				respuestasDB().filter({'id_pregunta':id_pregunta,'id_categoria':id_categoria,'id_item':id_item}).each(function () {
					existeRespuesta=true;
					return false;
				});
				if(existeRespuesta)// Si existe la respuesta, actualizarla
				{
					respuestasDB({'id_pregunta':id_pregunta,'id_categoria':id_categoria,'id_item':id_item}).update({valor_respuesta:valor,id_item:id_item,id_categoria:id_categoria});
				}
				else // Sino existe la respuesta, agregarla		
				{
					respuestasDB.insert(new respuesta(id_respuesta,valor,id_item,id_pregunta,id_categoria));              
					id_respuesta++;
				}				
				break;
				
		}        				
        respuestasDB().each(function (r1) {
           // console.log(r1); 
        });
    }				

	function save_content_to_file(content, filename){		
		var dlg = false;
		with(document){
		 ir=createElement('iframe');
		 ir.id='ifr';
		 ir.location='about.blank';
		 ir.style.display='none';
		 body.appendChild(ir);
		
		  with(getElementById('ifr').contentWindow.document){
			   open("text/plain", "replace");
			   charset = "utf-8";
			   write(content);
			   close();
			   document.charset = "utf-8";
			   dlg = execCommand('SaveAs', true, filename);
		   }
		   //body.removeChild(ir);
		 }
		return dlg;
	}	
	
	function ocultar_pregunta(pregunta,sentido)
	{			
		$("#contenedor_pregunta"+pregunta).hide();
	}	
	
	function mostrar_pregunta(pregunta,sentido)
	{			
		$("#contenedor_pregunta"+pregunta).show();
	}
	
	function validar_cuestionario(){
	
		var ok=true;	
		var flag=false;
	
		preguntasDB().each(function(pregunta){
		
			if(flag)
				return false;
		
			var tieneCategoria=false;			
			var tipo1=parseInt(pregunta.tipo);
			var tipo2=parseInt(pregunta.tipo2);			
			var aux=false;																					
			
			switch(tipo1)
			{
				case 1: //Tipo alternativa
				
				preguntas_categoriasDB().filter({'id_pregunta':pregunta.id_pregunta}).each(function(categoria){
					tieneCategoria=true;
					return false;
				});
				
					switch(tipo2)
					{
						case 1: // Tipo disyuntiva												
						
							if(tieneCategoria)
							{							
								var maxCat;
																											
								if(pregunta.id_pregunta>33)
								{
									respuestasDB().filter({'id_pregunta':33}).each(function(r20){												
										maxCat=parseInt(r20.valor_respuesta);												
									});
								}
								else
								{
									maxCat=15;
								}
								
								var contCat=0;
										
								var flag2=false;
							
								var cont1=1;								
								preguntas_categoriasDB().filter({'id_pregunta':pregunta.id_pregunta}).each(function(categoria){		
									if(flag2)
										return false;								
										
									var cont2=0;
									respuestasDB().filter({'id_pregunta':pregunta.id_pregunta,'id_categoria':(categoria.id_categoria).toString()}).each(function(){
										cont2++;
									});
									cont1=cont1*cont2;
									
									contCat++;
											
									if(contCat>=maxCat)																						
										flag2=true;									
								});
								if(cont1!=0) // Para cada categoria debe haber una respuesta
									aux=true; 
							}
							else
							{								
								respuestasDB().filter({'id_pregunta':pregunta.id_pregunta}).each(function(respuesta){
									aux=true;	
									return false;
								});
							}
							break;
						case 2: // Tipo conjuntiva
							if(tieneCategoria)
							{
								var cont=0;
								preguntas_categoriasDB().filter({'id_pregunta':pregunta.id_pregunta}).each(function(categoria){	
 									// alert('soy categoria conjuuntiva');
									// alert(JSON.stringify(categoria)); 
									// alert(respuestasDB().filter({'id_pregunta':pregunta.id_pregunta}).stringify());
									respuestasDB().filter({'id_pregunta':pregunta.id_pregunta,'id_categoria':(categoria.id_categoria).toString()}).each(function(){									
										cont++;
										return false;
									});
								});
								if(cont>0) // Para al menos una categoria debe haber una respuesta
									aux=true; 								
							}
							else
							{
								respuestasDB().filter({'id_pregunta':pregunta.id_pregunta}).each(function(respuesta){
									aux=true;	
									return false;
								});
							}
							break;
						case 3: // Tipo conjuntiva con valor
							if(tieneCategoria)
							{
								var cont=0;
								preguntas_categoriasDB().filter({'id_pregunta':pregunta.id_pregunta}).each(function(categoria){									
									respuestasDB().filter({'id_pregunta':pregunta.id_pregunta,'id_categoria':(categoria.id_categoria).toString()}).each(function(){
										cont++;
										return false;
									});
								});
								if(cont>0) // Para al menos una categoria debe haber una respuesta
									aux=true;
							}
							else
							{
								respuestasDB().filter({'id_pregunta':pregunta.id_pregunta}).each(function(respuesta){
									if(respuesta.valor_respuesta!=null)						
										aux=true;						
								});
							}							
					}
					break;
				case 2: //Tipo valor					
					respuestasDB().filter({'id_pregunta':pregunta.id_pregunta}).each(function(respuesta){
						if(respuesta.valor_respuesta!=null)						
							aux=true;						
					});
					break;
			}
			ok=ok*aux;
			
			if(!ok)
			{								
				alert("La siguiente pregunta no ha sido correctamente respondida");				
				flag=true;
				cursor=pregunta.id_pregunta;
				cargar_contenido(cursor);				
			}
						
		});
		
		if(ok)
		{		
			if(confirm("Cuestionario completado correctamente, ¿Confirma el envío de la toma?"))
				enviar_toma();
		}		
		else
		{
			// alert('ups...algo raro paso');
		}
	}
	
	function enviar_toma(){			

		var obj_toma=new toma(new Date(),2,codigo_auditor,folio_sala,respuestasDB().get());
		
		html = "<div id='envio_toma' style='display:none' ></div>";
		$('body').append(html);	
		
		html = "<form id ='form' action='http://200.29.139.244/REDBULL/php/ingresar_toma.php' method='POST' >";
		html += "<input type='hidden' name='codigo_auditor' value='"+obj_toma.id_auditor+"' />";
		html += "<input type='hidden' name='folio_sala' value='"+obj_toma.id_sala+"' />";
		
		var cont=0;
		
		$(obj_toma.respuestas).each(function(key,value){	
			html += "<input type='hidden' name='categoria"+cont+"' value='"+value.id_categoria+"' />";			
			html += "<input type='hidden' name='pregunta"+cont+"' value='"+value.id_pregunta+"' />";			
			html += "<input type='hidden' name='item"+cont+"' value='"+value.id_item+"' />";						
			html += "<input type='hidden' name='valor"+cont+"' value='"+value.valor_respuesta+"' />";	
			cont++;
		});				
		html += "<input type='hidden' name='cont' value='"+cont+"' type='submit' />";
		html += "</form>";	
		$('body').append(html);				
		$('#form').submit();	
	}	
	
	function enviar_toma2(){		
		
		var xmlhttp;				
		
		// Para enviar la toma mediante GET el stream total se debe dividir en 3 segmentos (limite largo URL) (Maximo respuestas 155)
		
		// Primero Calculamos cantidad de respuestas
		
		var largo_respuestas=respuestasDB().get().length;		
		
		alert('largo_respuestas='+largo_respuestas);
		
		// Luego obtenemos desplazamientos en base al largo de las respuestas
		
		var offset1=largo_respuestas/3;
		var offset2=2*largo_respuestas/3;

		alert("offset1="+offset1);
		alert("offset2="+offset2);
		
		// Creamos los tres segmentos
		
		var obj_toma1=new toma(new Date(),2,codigo_auditor,folio_sala,respuestasDB().limit(offset1).select('id_pregunta','id_categoria','id_item','valor_respuesta'));		
		var obj_toma2=new toma(new Date(),2,codigo_auditor,folio_sala,respuestasDB().start(offset1+1).limit(offset1).select('id_pregunta','id_categoria','id_item','valor_respuesta'));				
		var obj_toma3=new toma(new Date(),2,codigo_auditor,folio_sala,respuestasDB().start(offset2+1).select('id_pregunta','id_categoria','id_item','valor_respuesta'));						
		
		alert(JSON.stringify(obj_toma1));
		alert(JSON.stringify(obj_toma2));
		alert(JSON.stringify(obj_toma3));
		// return false;
		// Luego se debe hacer 3 GETS para enviar cada segmento de la toma
		
		if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari			
			xmlhttp=new XMLHttpRequest();
		}
		else{// code for IE6, IE5
			xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
		}		
		xmlhttp.onreadystatechange=function(){
		
			if (xmlhttp.readyState==4 && xmlhttp.status==200){
				
				var data = JSON.parse(xmlhttp.responseText);
				
				// Recuperamos el id de la toma que se ingreso en el GET
				var id_toma= data.id_toma;
				
				switch(parseInt(data.Codigo))
				{
					case 0:
						alert("Error al ingresar la toma, porfavor vuelva a intentarlo más tarde");
						break;
					case 1: // Si el primer envio fue exitoso continuar con el segundo envio
					
						// Si el segundo segmento esta vacio terminar el proceso
						
						if($.isEmptyObject(obj_toma2.respuestas))
						{
							alert("Envio completado con exito. Por favor confirme el siguiente diálogo para actualizar el estado de la toma");
							obj_toma= new toma(new Date(),3,codigo_auditor,folio_sala,respuestasDB().get());		
							save_content_to_file(JSON.stringify(obj_toma), pathCuestionario);
							return true;
						}
						
						alert(xmlhttp.responseText);
						var xmlhttp2;
						
						if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari			
							xmlhttp2=new XMLHttpRequest();
						}
						else{// code for IE6, IE5
							xmlhttp2=new ActiveXObject("Microsoft.XMLHTTP");
						}		
						xmlhttp2.onreadystatechange=function(){
						
							if (xmlhttp2.readyState==4 && xmlhttp2.status==200){
								
								alert(xmlhttp2.responseText);
								var data2 = JSON.parse(xmlhttp2.responseText);
								
								switch(parseInt(data2.Codigo))
								{
									case 0:
										alert("Error al ingresar la toma, porfavor vuelva a intentarlo más tarde");
										break;
									case 1: // Si el segundo envio fue exitoso continuar con el tercer envio
									
										// Si el segundo segmento esta vacio terminar el proceso
						
										if($.isEmptyObject(obj_toma3.respuestas))
										{
											alert("Envio completado con exito. Por favor confirme el siguiente diálogo para actualizar el estado de la toma");
											obj_toma= new toma(new Date(),3,codigo_auditor,folio_sala,respuestasDB().get());		
											save_content_to_file(JSON.stringify(obj_toma), pathCuestionario);
											return true;
										}
										
										var xmlhttp3;
										
										if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari			
											xmlhttp3=new XMLHttpRequest();
										}
										else{// code for IE6, IE5
											xmlhttp3=new ActiveXObject("Microsoft.XMLHTTP");
										}		
										xmlhttp3.onreadystatechange=function(){
										
											if (xmlhttp3.readyState==4 && xmlhttp3.status==200){
												
												alert(xmlhttp3.responseText);
												var data3 = JSON.parse(xmlhttp3.responseText);
												
												switch(parseInt(data3.Codigo))
												{
													case 0:
														alert("Error al ingresar la toma, porfavor vuelva a intentarlo más tarde");
														break;
													case 1: // Si el tercer envio fue exitoso actualizar el estado de la toma local	
														alert("Envio completado con exito. Por favor confirme el siguiente diálogo para actualizar el estado de la toma");
														obj_toma= new toma(new Date(),3,codigo_auditor,folio_sala,respuestasDB().get());		
														save_content_to_file(JSON.stringify(obj_toma), pathCuestionario);														
														return true;													
														break;
												}
											}	
										}		
										// alert(JSON.stringify(obj_toma3));
										xmlhttp3.open("GET","http://200.29.139.244/REDBULL/php/cargar_maestra2.php?caso=3&id_toma="+id_toma+"&toma="+JSON.stringify(obj_toma3),true);
										xmlhttp3.send();																			
										break;
								}
							}	
						}
						// alert(id_toma);
						// alert(JSON.stringify(obj_toma2));
						xmlhttp2.open("GET","http://200.29.139.244/REDBULL/php/cargar_maestra2.php?caso=2&id_toma="+id_toma+"&toma="+JSON.stringify(obj_toma2),true);
						xmlhttp2.send();			
						break;
				}
			}	
		}		
		xmlhttp.open("GET","http://200.29.139.244/REDBULL/php/cargar_maestra2.php?caso=1&toma="+JSON.stringify(obj_toma1),true);
		xmlhttp.send();				
	}		
	
$(document).ready(function() {		

	// $('button').button();
	$('button').css('padding','0em');
	$('span').css('padding','0em');	
	var callbacks = $.Callbacks();
	callbacks.add( cargar_datos() );
	callbacks.add( cargar_auditores() );	
		
	$('#guardar').click(function(){		
		
		var obj_toma=new toma(new Date(),1,codigo_auditor,folio_sala,respuestasDB().get());			
		
		save_content_to_file(JSON.stringify(obj_toma), pathCuestionario);
	});
	
	$('.cursor').click(function(){			
	
		$(this).addClass('ui-state-active');
	
		ocultar_pregunta(cursor);
	
		if($(this).attr('id')==='ant')
		{			
            if(cursor>1)							
                cursor--;				
		}
		else
		{			
            if(cursor<42)							
                cursor++;					
		}

		mostrar_pregunta(cursor);
	});
	
	$('#enviar').click(function(){
		enviar_toma2();
		// validar_cuestionario();
	});
		
	
});
</script>
</head>
<body>

<div id="container" style="width:100%;display:none;">
<table id='cuestionario' width='100%' class='display table' border=1>
			<thead>
            <tr style="background-color:#000000">
				<th style='vertical-align:middle'>
						<h4 style="color:#FFFFFF;">
								CUESTIONARIO PSA
						</h4>
				</th>
            </tr>
			<thead>
			<tbody>
            <tr>
				<td style='vertical-align:middle'>
					<table id='topico1' class='display table miDataTable' width='100%'>
						<thead>	
							<tr>
								<th id='head_topico1'>
									Topico1
								</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>
									<table id='seccion11' class='display table miDataTable' width='100%'> 
										<thead>
											<tr>
												<th>
													Seccion11
												</th>
											</tr>
										</thead>
										<tbody>
										</tbody>
									</table>
								</td>
							</tr>
							<tr>
								<td>
									<table id='seccion12' class='display table miDataTable' width='100%'>
										<thead>
											<tr>
												<th>
													Seccion12
												</th>
											</tr>
										</thead>
										<tbody>
										</tbody>
									</table>
								</td>
							</tr>	
							<tr>
								<td>
									<table id='seccion13' class='display table miDataTable' width='100%'>
										<thead>
											<tr>
												<th>
													Seccion13
												</th>
											</tr>
										</thead>
										<tbody>
										</tbody>
									</table>
								</td>
							</tr>
							<tr>
								<td>
									<table id='seccion14' class='display table miDataTable' width='100%'>
										<thead>
											<tr>
												<th>
													Seccion14
												</th>
											</tr>
										</thead>
										<tbody>
										</tbody>
									</table>
								</td>
							</tr>
							<tr>
								<td>
									<table id='seccion15' class='display table miDataTable' width='100%'>
										<thead>
											<tr>
												<th>
													Seccion15
												</th>
											</tr>
										</thead>
										<tbody>
										</tbody>
									</table>
								</td>
							</tr>							
						</tbody>
					</table>		
				</td>
            </tr>
            <tr>
				<td style='vertical-align:middle'>
					<table id='topico2' class='display table miDataTable' width='100%'>
						<thead>						
							<tr>
								<th id='head_topico2'>
									Topico2
								</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>
									<table id='seccion26' class='display table miDataTable' width='100%'>
										<thead>
											<tr>
												<th>
													Seccion21
												</th>
											</tr>
										</thead>
										<tbody>
										</tbody>
									</table>
								</td>
							</tr>
							<tr>
								<td>
									<table id='seccion27' class='display table miDataTable' width='100%'>
										<thead>
											<tr>
												<th>
													Seccion22
												</th>
											</tr>
										</thead>
										<tbody>
										</tbody>
									</table>
								</td>
							</tr>	
							<tr>
								<td>
									<table id='seccion28' class='display table miDataTable' width='100%'>
										<thead>
											<tr>
												<th>
													Seccion23
												</th>
											</tr>
										</thead>
										<tbody>
										</tbody>
									</table>
								</td>
							</tr>								
						</tbody>
					</table>		
				</td>
            </tr>		
			<tr>
				<td style='vertical-align:middle'>
					<table id='topico3' class='display table miDataTable' width='100%'>
						<thead>						
							<tr>
								<th id='head_topico3'>
									Topico3
								</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>
									<table id='seccion39' class='display table miDataTable' width='100%'>
										<thead>
											<tr>
												<th>
													Seccion31
												</th>
											</tr>
										</thead>
										<tbody>
										</tbody>
									</table>
								</td>
							</tr>
							<tr>
								<td>
									<table id='seccion310' class='display table miDataTable' width='100%'>
										<thead>
											<tr>
												<th>
													Seccion32
												</th>
											</tr>
										</thead>
										<tbody>
										</tbody>
									</table>
								</td>
							</tr>								
						</tbody>
					</table>		
				</td>
            </tr>		
		</tbody>
    </table>			
	
    <table width='70%' align='center'>    
        <tr>
            <td width='20%'>
                <button class='cursor' id='ant' style='padding:0em;margin:0em'>
                    <img src='images/arrow-left.png' style='width:4em;height:3em'/>
                </button>                
            </td>
            <td width='20%'>
                <button id='guardar' style='width:100%;height:50%'>
                    <img src='images/System-Save-icon.png' style='width:4em;height:3em'/>
                </button>  
            </td>
            <td width='20%'>
                <button id='enviar' style='width:100%;height:50%'>
                    <img src='images/600px-Black_check.svg.png' style='width:4em;height:3em'/>
                </button> 
            </td>
            <td width='20%'>
                <button class='cursor' id='sig' style='padding:0em;margin:0em'>
                    <img src='images/arrow.png' style='width:4em;height:3em'/>
                </button>	
            </td>
        </tr>
    </table>
</div>
<div id="sesion" style="width:100%;">
	<table width='100%'>
			<thead>
            <tr style="background-color:#000000">
                    <th style='vertical-align:middle'>
						<h4 style="color:#FFFFFF;">
								Ingreso Usuario
						</h4>
                    </th>
            </tr>
			<thead>
		<tr>
			<td>
				<div id='auditores'>
					<h2>
						Cargando auditores...
					</h2>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				<div id='salas'>
				</div>
			</td>
		</tr>
	</table>
</div>
</body>
</html>